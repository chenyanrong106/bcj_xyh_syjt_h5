@{
    ViewBag.Title = "预约登记";
    Layout = "~/Views/Shared/_LayoutB.cshtml";
}
@model SPACRM.Entity.Entities.CUST_BOOKING_EX
@section htmlhead{
    @Html.Css("plugin/validator")
    <link href="~/assets/plugins/jqueryui-timepicker/jquery.ui.timepicker.css" rel="stylesheet" />

    <style type="text/css">
        .h_title {
            padding: 5px 15px;
            border-bottom: solid 1px #e6e5e5;
            font-size: 18px;
            margin-bottom: 5px;
        }

        .col-sm-8 {
            padding: 0;
        }

        #CUST_MOBILE, #CUST_NAME {
            height: 23px;
            width: 400px;
        }

        label {
            vertical-align: text-bottom;
        }
    </style>
}
<div style="margin: -2px 15px;">
    <div id="h_title" class="h_title">预约登记</div>
    <div>
        <form id="frmEdit" action="@Url.Action("NewSave")" method="post" role="form" >
            <input type="hidden" id="ID" name="ID" value="@Model.ID" />
            <div class="form-group">
                <div class="row">
                    <label class="col-xs-2 control-label" for="ORG_NAME">顾客电话</label>
                    <div class="col-xs-9">
                        @Html.TextBox("CUST_MOBILE", Model.CUST_MOBILE, new { @class = "form-control", placeholder = "请输入顾客电话", maxlength = "16" })
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="row">
                    <label class="col-xs-2 control-label" for="ORG_NAME">顾客姓名</label>
                    <div class="col-xs-9">
                        @Html.TextBox("CUST_NAME", Model.CUST_NAME, new { @class = "form-control", placeholder = "请输入顾客姓名", maxlength = "32" })

                    </div>
                </div>

            </div>
            <div class="form-group">
                <div class="row">
                    <label class="col-xs-2 control-label" for="ORG_NAME">项目类别</label>
                    <div class="col-xs-9">
                        @if(Model.PAY_STATUS==1){
                        @Html.ResourceDropDownList("SER_TYPE", "SER_TYPE", Model.SERVICE_TYPE, new { @class = "form-control",@disabled="disabled" }, (string)ViewBag.Org_Id, false)
                        }else{
                        @Html.ResourceDropDownList("SER_TYPE", "SER_TYPE", Model.SERVICE_TYPE, new { @class = "form-control" }, (string)ViewBag.Org_Id, false)
                        }
                    </div>
                </div>

            </div>
            <div class="form-group">
                <div class="row">
                    <label class="col-xs-2 control-label" for="SERVICE_NAME">服务项目</label>
                    <div class="col-xs-9">
                         @if (Model.PAY_STATUS == 1)
                         {
                             <input type="hidden" class="populate" name="SERVICE_NAME" id="SERVICE_PRODUCT" disabled="disabled" style="width:100%" value="@Model.SERVICE_NAME" />
                         }else{
                        <input type="hidden" class="populate" name="SERVICE_NAME" id="SERVICE_PRODUCT" style="width:100%" value="@Model.SERVICE_NAME" />
                         }
                    </div>
                </div>

            </div>
            <div class="form-group">
                <div class="row">
                    <label class="col-xs-2 control-label" for="SERVICE_NAME">日期</label>
                    <div class="col-xs-9">
                        @Html.TextBox("CREATE_DATE", @Request.QueryString["date"] == null ? Model.BEGIN_DATE.ToString("yyyy-MM-dd") : @Request.QueryString["date"], new { @class = "form-control" })
                    </div>
                </div>

            </div>
            <div class="form-group">
                <div class="row">
                    <label class="col-xs-2 control-label" for="BRAND">时  间</label>
                    <div class="col-xs-9">
                        <div class="input-group date">
                            @Html.TextBox("BEGINTIME", Request.QueryString["starthm"] == null ? Model.BEGIN_DATE.ToString("HH:mm") : Request.QueryString["starthm"], new { @class = "form-control col-xs-4" })
                            <span class="input-group-addon">到</span>
                            @Html.TextBox("ENDTIME", Request.QueryString["endhm"] == null ? Model.END_DATE.ToString("HH:mm") : Request.QueryString["endhm"], new { @class = "form-control col-xs-4" })
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="row">
                    <label class="col-xs-2 control-label" for="MANAGER"></label>
                    <div class="col-xs-9">
                        <label class="col-xs-3">
                            @Html.CheckBox("IS_STAFF", Model.IS_STAFF)
                            指定技师
                        </label>
                        <label class="col-xs-3">
                            <input type="checkbox" name="InStore" @(Model.SOURCE == "3" ? "checked" : "") />
                            直接到店
                        </label>
                        @*<label class="col-xs-6">
                             指定性别
                          @Html.ResourceRadioList("IS_STAFF_GENDER", "IS_STAFF_GENDER",Model.IS_STAFF_GENDER.Equals("")?2:Model.IS_STAFF_GENDER, null)
                             </label>*@
                    </div>

                </div>
            </div>
            <div id="divStaff" class="form-group">
                <div class="row">
                    <label class="col-xs-2 control-label" for="MANAGER">技  师</label>
                    <div class="col-xs-9">
                        @Html.ResourceDropDownList("STAFF_ID", "Masseur", Request.QueryString["mid"], new { @class = "form-control" }, (string)ViewBag.Store_ID, false)
                    </div>
                    @* <label class="col-xs-2 control-label" for="MANAGER"><span id="addStaff">+新增</span></label>*@
                </div>

            </div>
            <div class="form-group">
                <div class="row">
                    <label class="col-xs-2 control-label" for="BED">房  间</label>
                    <div class="col-xs-9">
                        @Html.ResourceDropDownList("ROOM_ID", "ROOM", Model.ROOM_ID.ToString(), new { @class = "form-control" }, (string)ViewBag.Store_ID, true)
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="row">
                    <label class="col-xs-2 control-label" for="BED">预约人数</label>
                    <div class="col-xs-9">
                        @Html.TextBox("BOOKING_NUM", Model.BOOKING_NUM == null ? 1 : Model.BOOKING_NUM, new { @class = "form-control", type = "number", placeholder = "请输入预约人数", maxlength = "32" })
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="row">
                    <label class="col-xs-2 control-label" for="BED">备  注</label>
                    <div class="col-xs-9">
                        @Html.TextArea("REMARK", Model.REMARK, new { @class = "form-control", placeholder = "请输入备注信息", maxlength = "120" })
                    </div>
                </div>
            </div>

            @*            <div class="form-group col-xs-6">
                <label class="col-sm-1 control-label" for="ORG_NAME">顾客电话</label>
                <div class="col-sm-10">
                    @Html.TextBox("CUST_MOBILE", Model.CUST_MOBILE, new { @class = "form-control", placeholder = "请输入顾客电话", maxlength = "16" })
                </div>

            </div>

            <div class="form-group col-xs-6">
                <label class="col-sm-1 control-label" for="ORG_NAME">顾客姓名</label>
                <div class="col-sm-10">
                    @Html.TextBox("CUST_NAME", Model.CUST_NAME, new { @class = "form-control", placeholder = "请输入顾客姓名", maxlength = "32" })

                </div>

            </div>*@



            @*  <div class="form-group col-xs-6">
                <label class="col-xs-3 control-label" for="ORG_NAME">顾客电话</label>
                <div class="col-xs-9">
                    @Html.TextBox("CUST_MOBILE", Model.CUST_MOBILE, new { @class = "form-control", placeholder = "请输入顾客电话", maxlength = "16" })
                </div>

            </div>
            <div class="form-group col-xs-6">
                <label class="col-xs-3 control-label" for="SERVICE_NAME">顾客姓名</label>
                <div class="col-xs-9">
                     @Html.TextBox("CUST_NAME", Model.CUST_NAME, new { @class = "form-control", placeholder = "请输入顾客姓名", maxlength = "32" })
                </div>
            </div>


            <div class="form-group">
                <div class="row">
                    <label class="col-xs-2 control-label" for="MANAGER"></label>
                    <div class="col-xs-10">
                       <label class="col-xs-5">
                        @Html.CheckBox("IS_STAFF", Model.IS_STAFF)
                        指定技师
                        </label>

                         <label class="col-xs-5">
                             指定性别
                                    @Html.ResourceRadioList("IS_STAFF_GENDER", "IS_STAFF_GENDER",Model.IS_STAFF_GENDER, null)
                             </label>
                    </div>
                  
                </div>
            </div>



              <div class="form-group col-xs-6">
                <label class="col-xs-3 control-label" for="ORG_NAME">开始时间</label>
                <div class="col-xs-9">
                    @Html.TextBox("BEGINTIME",Request.QueryString["starthm"], new { @class = "form-control" })
                </div>

            </div>
            <div class="form-group col-xs-6">
                <label class="col-xs-3 control-label" for="SERVICE_NAME">服务项目</label>
                <div class="col-xs-9">
                    @Html.ResourceDropDownList("SER_TYPE2", "SER_TYPE", null, new { @class = "form-control" }, (string)ViewBag.Org_Id, false)
                </div>
            </div>

             <div class="form-group col-xs-6">
                <label class="col-xs-3 control-label" for="ORG_NAME">技&nbsp;&nbsp;师</label>
                <div class="col-xs-9">
                     @Html.ResourceDropDownList("STAFF_ID", "Masseur",Request.QueryString["mid"], new { @class = "form-control" },null, true)
                </div>

            </div>
         
               <div class="form-group col-xs-6">
                <label class="col-xs-3 control-label" for="SERVICE_NAME">房&nbsp;&nbsp;间</label>
                <div class="col-xs-9">
                    @Html.ResourceDropDownList("ROOM_ID", "ROOM", Model.ROOM_ID.ToString(), new { @class = "form-control" },Model.STORE_ID.ToString().Equals("0")?(string)ViewBag.Store_ID:Model.STORE_ID.ToString(), true)
                </div>
            </div>*@


            <div class="btnpanel_right">
                <button type="reset" id="btnCancel" class="btn btn-default">取 消  </button>
                <button type="button" id="btnSave" class="btn btn-primary">保 存  </button>
            </div>

            <input type="hidden" id="CUST_ID" name="CUST_ID" />
            <input type="hidden" name="STORE_ID" id="STORE_ID" value="@ViewBag.Store_ID" />

            @{
                var storeName = ViewBag.Store_Name;
                storeName = string.IsNullOrEmpty(storeName) ? MyContext.CurrentLoginUser.STORE_NAME : storeName;
            }

            <input type="hidden" name="STORE_NAME" id="STORE_NAME" value="@storeName" />
            <input type="hidden" id="hideSERVICE_TYPE" name="SERVICE_TYPE" />
        </form>



    </div>
</div>
@*<div style="display: none;">
    <textarea readonly="readonly" class="fullscreen" style="display: none; height: 0px; width: 0px;"></textarea>
</div>*@

<link rel='stylesheet' type='text/css' href='~/assets/plugins/form-select2/select2.css' />
@*<script src="~/assets/js/jquery-ui-1.10.4.custom.min.js"></script>*@
@section jssection{
    <script type="text/javascript">
        var util = {};
        var options = {
            queryMemberUrl: "@Url.Action("QueryCustomers", "Customer")",
            querySerItemUrl: "@Url.Action("ServiceItem", "Service")",
            querySerCateItemUrl: "@Url.Action("ServiceCatrgoryItem", "Service")",
            checkMobile: "@Url.Action("CheckMobile")",
            validStaffConfict: "@Url.Action("ValidStaffConfict")"
        };
    </script>
    @Html.Js("plugins/validator/validator", "plugins/form-datepicker/js/bootstrap-datepicker", "plugins/form-datepicker/js/locales/bootstrap-datepicker.zh-CN", "app/booking/new")
    @Html.Js("plugins/form-select2/select2")
}



