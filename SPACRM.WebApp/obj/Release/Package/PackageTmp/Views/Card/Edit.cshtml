@{
    ViewBag.Title = "编辑会员卡信息";
    var orgId = ViewData["ORG_ID"] == null ? "0" : ViewData["ORG_ID"].ToString();
}
@model SPACRM.Entity.ProductCard

@section htmlhead{
    @Html.Css("plugin/validator", "plugin/xjgrid")
    <style type="text/css">
        .h_title {
            padding: 5px 15px;
            border-bottom: solid 1px #e6e5e5;
            font-size: 18px;
            margin-bottom: 5px;
        }

        .btnpanel_right {
            float: right;
        }

        .btnpanel {
            text-align: center;
        }

        .col-sm-8 {
            padding: 0;
        }

        .filter_panel {
        }
    </style>
}
<div style="margin: -2px 15px; background-color: #fff;">
    <div id="page-heading">
        <h2>
            <i class="fa fa-credit-card"></i>储值卡/券信息维护
        </h2>
    </div>
    @*<div class="h_title">会员卡信息维护</div>*@
    <div>
        <div class="tab-container">
            <ul class="nav nav-tabs">
                <li class="active" id="foundli"><a href="#BASE_INFO" data-toggle="tab">基础信息</a></li>
                <li style="display: none"><a href="#SERVICE" id="tab_service" data-toggle="tab">适用的项目</a></li>
                <li style="display: none"><a href="#PRODUCT" id="tab_product" data-toggle="tab">适用的产品</a></li>
                <li id="storeli"><a href="#STORE" id="tab_store" data-toggle="tab">适用的门店</a></li>
            </ul>
            <div class="tab-content">
                <div class="tab-pane active" id="BASE_INFO" style="overflow: hidden; zoom: 1">
                    <form id="frmEdit" action="@Url.Action("Save")" method="post" role="form">
                        @Html.Hidden("ID", Model.ID)
                        @Html.Hidden("flag",0)
                        <div class="form-group col-xs-10">
                            <label for="NAME" class="col-sm-3 control-label"  style="text-align:right;">
                                <abbr>*</abbr>
                                名 称:</label>
                            <div class="col-sm-8">

                                @Html.TextBox("NAME", Model.NAME, new { @class = "form-control", placeholder = "请输入卡片名称" })
                            </div>
                        </div>
                        <div class="form-group col-xs-10">
                            <label class="col-sm-3 control-label" for="PAR_AMT"  style="text-align:right;">
                                <abbr>*</abbr>卡/券类型:</label>
                            <div class="col-sm-8">
                                
                                @Html.ResourceDropDownList("TYPE", "PROD_CARD_TYPE", Model.TYPE, new { @class = "form-control", style = "width:200px;" }, "", false)

                            </div>
                        </div>
                        <div class="form-group col-xs-10">
                            <label class="col-sm-3 control-label" for="PAR_AMT"  style="text-align:right;">
                                <abbr>*</abbr>卡内充值:</label>
                            <div class="col-sm-8">
                                @Html.TextBox("PAR_AMT", Model.PAR_AMT, new { @class = "form-control", placeholder = "请输入卡内充值数额" })
                            </div>
                        </div>
                        <div class="form-group col-xs-10">
                            <label class="col-sm-3 control-label" for="PRICE"  style="text-align:right;">
                                <abbr>*</abbr>售  价:</label>
                            <div class="col-sm-8">
                                @Html.TextBox("PRICE", Model.PRICE, new { @class = "form-control", placeholder = "请输入售价" })
                            </div>
                        </div>
                        <div class="form-group col-xs-10">
                            <label class="col-sm-3 control-label" for="DISCOUNT_RATE"  style="text-align:right;">
                                <abbr>*</abbr>项目折扣:</label>
                            <div class="col-sm-8">
                                @Html.TextBox("DISCOUNT_RATE", Model.DISCOUNT_RATE, new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="form-group col-xs-10">
                            <label class="col-sm-3 control-label" for="DISCOUNT_RATE"  style="text-align:right;">
                                <abbr>*</abbr>产品折扣:</label>
                            <div class="col-sm-8">
                              
                                    @Html.TextBox("DISCOUNT_RATE2",Model.ID==0?1: Model.DISCOUNT_RATE2, new { @class = "form-control" })
                               
                            </div>
                        </div>
                        <div class="form-group col-xs-10">
                            <label class="col-sm-3 control-label"  style="text-align:right;">
                                <abbr>*</abbr>有效期:</label>
                            <div class="col-sm-8">
                                @{
                                    if (Model.IS_OPEN_AVA)
                                    {
                                    <label>
                                        <input type="radio" name="IS_OPEN_AVA" checked="checked" value="True" />以开卡时间算</label>
                                    <label>
                                        <input type="radio" name="IS_OPEN_AVA" value="False" />以办卡时间算</label>
                                    }
                                    else
                                    {
                                    <label>
                                        <input type="radio" name="IS_OPEN_AVA" value="True" />以开卡时间算</label>
                                    <label>
                                        <input type="radio" name="IS_OPEN_AVA" checked="checked" value="False" />以办卡时间算</label>
                                    }
                                }
                            </div>
                            <div class="col-sm-3">
                            </div>
                            <div class="col-sm-8">
                                @Html.TextBox("PERIOD", Model.PERIOD, new { @class = "form-control", placeholder = "持续月份，单位为‘月’",style="width:50px" }) 月
                            </div>
                        </div>
                        <div style="clear: both;"></div>

                        <div class="form-group col-xs-10">
                            <label class="col-sm-3 control-label"  style="text-align:right;">图片:</label>
                            <div class="col-sm-8">
                                <div style="width: 200px;">
                                    <iframe src="@Url.Action("UploadImage", "Helper", new { upid = "smallimg", showtip = "选择小图", type = 1 })" frameborder="0" style="width: 167px; height:102px; border: none; margin: 0; float: left;"></iframe>
                                </div>
                                <div style="margin: 1px 4px; border: solid 1px #ccc; padding: 4px; float: left; display: inline-block;">
                                    <img style="width:200px;height:140px;" id="IMAGE_SHOW" src="@Url.Action("ViewImage", "Helper", new { id = Model.IMAGE_ID.HasValue ? Model.IMAGE_ID.Value : 0 })" alt="" />
                                </div>
                                <input type="hidden" id="IMAGE_ID" name="IMAGE_ID" value="@Model.IMAGE_ID" />
                            </div>
                        </div>
                        <div class="form-group col-xs-10">
                            <label class="col-sm-3 control-label" for="REMARK"  style="text-align:right;">状态:</label>
                            <div class="col-sm-8 input-group">
                                @Html.ResourceRadioList("STATUS", "CARD_STATUS",Model.ID==0? Model.STATUS =1: Model.STATUS, null)
                            </div>
                        </div>
                        <div class="form-group col-xs-10">
                            <label class="col-sm-3 control-label" style="text-align:right;"><span style="color: red">*</span>是否可以用积分兑换:</label>
                            <div class="col-sm-8 input-group">
                                @if (Model.ID == 0)
                                {
                                    @Html.ResourceRadioList("IS_GIFT", "YES_NO", "0", null);
                                }
                                else
                                {
                                    @Html.ResourceRadioList("IS_GIFT", "YES_NO", Model.IS_GIFT == null ? "0" : (Model.IS_GIFT.Value  ? "1" : "0"), null);
                                }
                            </div>
                        </div>

                        @{ string sDisplay = (Model.IS_GIFT.HasValue && Model.IS_GIFT.Value)? "":"none" ;}
                         
                            <div class="form-group col-xs-10" id="divPoint" style="text-align:right;display:@sDisplay">
                                <label class="col-sm-3 control-label">兑换消耗积分:</label>
                                <div class="col-sm-8">
                                    @Html.TextBox("POINTS", Model.POINTS, new { @class = "form-control", placeholder = "请输入所需兑换积分", maxlength = "10" })
                                </div>
                            </div>
                        <div class="form-group col-xs-10">
                            <label class="col-sm-3 control-label" for="REMARK"  style="text-align:right;">备注:</label>
                            <div class="col-sm-8 input-group">
                                @Html.TextArea("REMARK", Model.REMARK, new { @class = "form-control", rows = "6" })
                            </div>
                        </div>
                        <div class="form-group col-xs-9 btnpanel_right">
                            <button type="button" id="btnSave" style="width: 100px;" class="btn btn-primary">保 存  </button>
                            <button type="reset" id="btnCancel" class="btn btn-default">取 消  </button>
                        </div>

                    </form>
                </div>
                <div class="tab-pane" id="SERVICE">
                    <div class="filter_panel">
                        <form id="service_frm_q" class="form-inline" role="form">
                            <div class="form-group">
                                <label class="col-sm-5 control-label" for="exampleInputEmail2">项目名称:</label>
                                <input type="text" class="form-control" id="S_QTEXT" placeholder="按项目名称筛选" name="ItemName">
                            </div>
                            <div class="form-group">
                                <label class="col-sm-5 control-label" for="exampleInputPassword2">
                                    项目大类:
                                </label>
                                @{
                                    string parentCode = ViewBag.OrgID.ToString();
                                }
                                @Html.ResourceDropDownList("BCATE", "SER_BIGTYPE", "服务项目类别", new { @class = "form-control", style = "width:200px;" }, parentCode, false)

                            </div>

                            <div class="form-group">
                                <label class="col-sm-5 control-label" for="exampleInputPassword2">
                                    项目小类:
                                </label>
                                <select class="form-control" id="PRO_TYPE" name="SCATE">
                                    <option value="">请选择项目小类</option>
                                </select>
                            </div>

                            <button type="button" id="S_Filter" class="btn btn-default">筛 选</button>
                        </form>
                    </div>
                    <div id="SERVICE_INFO" style="margin: 5px 0;">
                        11111
                    </div>
                    <div class="btnpanel">
                        <button type="button" id="btnServiceSave" style="width: 100px;" class="btn btn-primary">保 存  </button>
                    </div>
                </div>
                <div class="tab-pane" id="PRODUCT" style="margin: 5px 0;">
                    <div class="filter_panel">
                        <form id="product_frm_q" class="form-inline" role="form" onsubmit="return false;">
                            @*  <div class="form-group">
                                <label class="col-sm-5 control-label" for="exampleInputEmail2">产品名称:</label>
                                <input type="text" class="form-control" id="P_QTEXT" placeholder="按产品名称筛选">
                            </div>
                            <div class="form-group">
                                <label class="col-sm-5 control-label" for="exampleInputPassword2">
                                    类别:
                                </label>                                
                                @Html.ResourceDropDownList("P_Category", "PROD_CATEGORY", "", new { @class = "form-control", style = "width:160px;" }, parentCode, true)
                            </div>*@
                            <div class="form-group">
                                <label class="col-sm-5 control-label" for="exampleInputEmail2">产品名称:</label>
                                <input type="text" class="form-control" id="P_QTEXT" placeholder="按产品名称筛选" name="PNAME">
                            </div>
                            <div class="form-group">
                                <label class="col-sm-5 control-label" for="exampleInputPassword2">
                                    产品大类:
                                </label>
                                @{
                                    string pCode = ViewBag.OrgID.ToString();
                                }
                                @Html.ResourceDropDownList("P_Category", "PROD_BIGCATEGORY", "产品类别", new { @class = "form-control", style = "width:200px;" }, pCode, false)

                            </div>

                            <div class="form-group">
                                <label class="col-sm-5 control-label" for="exampleInputPassword2">
                                    产品小类:
                                </label>
                                <select class="form-control" id="PSCATE" name="PSCATE">
                                    <option value="">请选择产品小类</option>
                                </select>
                            </div>
                            <button type="button" id="P_Filter" class="btn btn-default">筛 选</button>
                        </form>
                    </div>
                    <div id="PRODUCT_INFO" style="margin: 5px 0;">
                    </div>
                    <div class="btnpanel">
                        <button type="button" id="btnProductSave" style="width: 100px;" class="btn btn-primary">保 存  </button>
                    </div>
                </div>


                <div class="tab-pane" id="STORE" style="margin: 5px 0;">
                    <div class="filter_panel">
                        @*   <form id="store_frm_q" class="form-inline" role="form" onsubmit="return false;">
                            <div class="form-group">
                                <label class="col-sm-5 control-label" for="exampleInputEmail2">产品名称:</label>
                                <input type="text" class="form-control" id="P_QTEXT" placeholder="按产品名称筛选">
                            </div>
                            <div class="form-group">
                                <label class="col-sm-5 control-label" for="exampleInputPassword2">
                                    类别:
                                </label>                                
                                @Html.ResourceDropDownList("P_Category", "PROD_CATEGORY", "", new { @class = "form-control", style = "width:160px;" }, parentCode, true)
                            </div>
                            <button type="button" id="P_Filter" class="btn btn-default">筛 选</button>
                        </form>*@
                    </div>
                    <div id="STORE_INFO" style="margin: 5px 0;">
                    </div>
                    <div class="btnpanel">
                        <button type="button" id="btnStoreSave" style="width: 100px;" class="btn btn-primary">保 存  </button>
                    </div>
                </div>



            </div>
        </div>
    </div>
</div>
@section jssection{
    <script type="text/javascript">
        var _utils = {};
        var options = {
            S_QueryUrl: "@Url.Action("ListService")",
            P_QueryUrl: "@Url.Action("ListProduct")",
            Sto_QueryUrl: "@Url.Action("ListStore")",
            S_SaveUrl: "@Url.Action("SaveService")",
            P_SaveUrl: "@Url.Action("SaveProduct")",
            Sto_SaveUrl: "@Url.Action("SaveStore")",
            proTypeUrl: "@Url.Action("GetProdTypes")",
            proTypeUrl2: "@Url.Action("GetProdTypesById")",
            indexUrl: "@Url.Action("Index")"

        };
    </script>
    @Html.Js("plugins/validator/validator", "plugins/xjgrid/xjgrid", "app/card/edit")
}