@{
    ViewBag.Title = "打印小票";
    Layout = "~/Views/Shared/_LayoutD.cshtml";
}
@using SPACRM.Entity.Entities;
@section htmlhead{
    <style type="text/css">
        .h_title {
            padding: 5px 15px;
            border-bottom: solid 1px #e6e5e5;
            font-size: 18px;
            margin-bottom: 5px;
        }

        .col-sm-8 {
            padding: 0;
        }

        #td1 {
            border-bottom: 1px solid black;
        }
    </style>
}
<!DOCTYPE html>
<html>

<head>

    <title>sss</title>
</head>
<body style="text-align: left" onload="WindowPrint();">
    <div style="text-align: left">
     
        <table border="0" width="270" id="table6">
               <tr>
                <td align="center">
                    <h3>账户充值单</h3>
                     <h3>WELCOME</h3>
                </td>
            </tr>
             @* <tr>
                <td align="center">
                    <h3>WELCOME</h3>
                </td>
            </tr>*@
              <tr>
                <td colspan="2">
                    <hr size="0">
                </td>
            </tr>
            <tr>
                <td align="left">门店名称:<font face="宋体" size="3">@ViewBag.head.STORE_NAME </font></td>
            </tr>
            <tr>
                <td align="left">开卡日期:<font face="Garamond" size="3">@DateTime.Now.ToString("yyyy-MM-dd")</font></td>
            </tr>
            <tr>
                <td align="left">会员卡号:<font face="Garamond" size="3">@ViewBag.head.CUST_NO</font></td>
            </tr>

            <tr>
                <td align="left" height="1" color="00cccc" id="td1"></td>
            </tr>
        </table>



        <table border="0" width="270" id="table1">

            <tr>
                <th width="20%">名称</th>
                <th width="15%">标准价</th>
                <th style="text-align: left;width:65%">销售金额</th>
            </tr>
            <tr>
                <th width="60%">销售员</th>
            </tr>
            <tr>
                <td colspan="3">
                    <hr size="0">
                </td>
            </tr>
            @foreach (var item in (List<ORDER_DETAIL_EX>)ViewBag.proItemList)
            {
                <tr>
                    <td width="70%"><font face="Times New Roman">@item.PROD_NAME</font></td>
                    <td width="15%"><font face="Times New Roman">@item.PROD_PRICE</font></td>
                    <td width="15%"><font face="Times New Roman">@item.PAY_AMT</font></td>
                </tr>
                <tr>
                    <td align="left" colspan="2"><font face="Times New Roman">@ViewBag.head.CREATE_USER</font></td>
                </tr>	
            }
        </table>

        <table border="0" width="270" id="table10">
            <tr>
                <td colspan="2">
                    <hr size="0">
                </td>
            </tr>
            <tr>
                <td align="left" width="70%"><font face="Times New Roman">总计:</font></td>
                <td align="right" width="30%"><font face="Times New Roman">@ViewBag.head.PAYED_AMT</font></td>
            </tr>
            <tr>
                <td align="left" width="70%" colspan="2"><font face="Times New Roman">付款明细:</font></td>

            </tr>  
            
            @foreach (var item in (List<ORDER_PAYMENT_EX>)ViewBag.payments)
            { 
                var type="";
              <tr>
                   
                    @if (item.PAYMENT_TYPE == 0)
                    {
                        type = "现金";
                    }
                    else if (item.PAYMENT_TYPE == 1)
                    {
                        type = "银联POS";
                    }
                      else if (item.PAYMENT_TYPE == 2)
                    {
                        type = "应收帐款";
                    }
                      else if (item.PAYMENT_TYPE == 3)
                    {
                        type = "代金券";
                    }
                    else if (item.PAYMENT_TYPE == 5)
                    {
                        type = "会员卡";
                    }
                    else if (item.PAYMENT_TYPE == 6)
                    {
                        type = "电子券";
                    }
                    else if (item.PAYMENT_TYPE == 999)
                    {
                        type = "疗程支付";
                    }
                    else
                    {
                        type = "多种方式";
                    }
                    <td align="left" width="70%"><font face="Times New Roman">@type:</font></td>
                    <td align="right" width="30%"><font face="Times New Roman">@item.PAY_AMT</font></td>
               </tr>
            } 
            @* <tr>
			<td align="left" width="70%"><font face="Times New Roman">储值账户</font></td>
			<td align="right" width="30%"><font face="Times New Roman">222.00</font></td>
		</tr>*@
            <tr>
                <td colspan="2">
                    <hr size="0">
                </td>
            </tr>
        </table>

        <table border="0">

            <tr>
                <td style="width: 70px;">备注:</td>
                <td style="text-align: left;">@ViewBag.head.REMARK</td>
            </tr>

            <tr>
                <td><font face="Times New Roman">收银员:</font></td>
                <td><font face="Times New Roman">@ViewBag.head.CREATE_USER</font></td>
            </tr>
            <tr>
                <td style="width: 10px;"><font face="Times New Roman">打印时间:</font></td>
                <td style="text-align: left;">@DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss")</td>
            </tr>

            <tr>
                <td align="left"><font face="Times New Roman">客户签名:</font></td>
                <td align="left"><font face="Times New Roman"></font></td>
            </tr>

            <tr>
                <td></td>
            </tr>
            <tr>
                <td></td>
            </tr>
            <tr>
                <td></td>
            </tr>
            <tr>
                <td></td>
            </tr>
               <tr>
                <td></td>
            </tr>
   <tr>
                <td></td>
            </tr>
   <tr>
                <td></td>
            </tr>
   <tr>
                <td></td>
            </tr>
   <tr>
                <td></td>
            </tr>
   <tr>
                <td></td>
            </tr>
   <tr>
                <td></td>
            </tr>

            <tr>
                <td colspan="2" align="center"><font face="Times New Roman">扑满技术支持:021-62595122</font></td>

            </tr>
        </table>

    </div>
</body>

</html>

@section jssection{

    <script type="text/javascript" language="JavaScript">
        var HKEY_Root, HKEY_Path, HKEY_Key;
        HKEY_Root = "HKEY_CURRENT_USER";
        HKEY_Path = "\\Software\\Microsoft\\Internet Explorer\\PageSetup\\";
        //设置网页打印的页眉页脚为空
        function PageSetup_Null() {
            var Wsh = new ActiveXObject("WScript.Shell");
            HKEY_Key = "header";
            Wsh.RegWrite(HKEY_Root + HKEY_Path + HKEY_Key, "");
            HKEY_Key = "footer";
            Wsh.RegWrite(HKEY_Root + HKEY_Path + HKEY_Key, "");
            HKEY_Key = "margin_left"
            Wsh.RegWrite(HKEY_Root + HKEY_Path + HKEY_Key, "0.2");  //键值设定--左边边界

            HKEY_Key = "margin_top"
            Wsh.RegWrite(HKEY_Root + HKEY_Path + HKEY_Key, "0"); //键值设定--上边边界

            HKEY_Key = "margin_right"
            Wsh.RegWrite(HKEY_Root + HKEY_Path + HKEY_Key, "0"); //键值设定--右边边界

            HKEY_Key = "margin_bottom"
            Wsh.RegWrite(HKEY_Root + HKEY_Path + HKEY_Key, "0"); //键值设定--下边边界
        }
        function WindowPrint() {
            /// 隐藏不需要打印的内容
            try {
                PageSetup_Null();
            }
            catch (e) {
                var errorMsg = e.message + "\r" + "请设置:IE选项->安全->Internet->" + "ActiveX控件和插件" + "\r" + "对未标记为可安全执行脚本的ActiveX的控件初始化并执行脚本->允许/提示";
                //alert(errorMsg);
                return;
            }
            window.print();
        }
    </script>

    <script type="text/javascript">
        var util = {};
        var options = {

        };
    </script>
    @*    @Html.Js("app/customer/edit")*@
}