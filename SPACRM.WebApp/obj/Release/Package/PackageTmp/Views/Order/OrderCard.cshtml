@{
    ViewBag.Title = "订单管理";
}
@model SPACRM.Entity.Entities.ORDER_HEAD_EX
@using SPACRM.Entity.Entities
@section htmlhead{
    @Html.Css("plugin/validator", "plugin/xjdailog", "plugins/form-select2/select2","plugin/tip")
    <link href="~/assets/app/order/xjgrid.css" rel="stylesheet" />
    @Html.Css("js/jquery-ui-1.10.4.custom.min")
    <style type="text/css">
        .h_title {
            padding: 5px 15px;
            border-bottom: solid 1px #e6e5e5;
            font-size: 18px;
            margin-bottom: 5px;
        }

        .searchpanel {
            background-color: #f7f8fa; /*border: 1px solid #ccc;*/
            padding: 5px 15px;
            margin-left: 10px;
            border-radius: 4px;
        }

            .searchpanel .form-group label {
                margin-bottom: 4px;
            }
    </style>

    <style type="text/css">
        #tSpeedyPro {
            border: 1px solid #e6e5e5;
            font-size: 12px;
            margin-top: 0px;
        }

            #tSpeedyPro tr {
                cursor: pointer;
            }

        #tablePayList {
            font-size: 12px;
        }

        #tab-content {
            background-color: white;
            height: 460px;
        }

        .tdPice {
            text-align: right;
        }

        #divCustomer {
            height: 130px;
            display: none;
        }

            #divCustomer .panel {
                background-color: white;
                height: 130px;
            }

                #divCustomer .panel .divCustomer-tr {
                    border-bottom: 1px solid red;
                    border-top: 2px solid #fff;
                }

        #divNewCustomer {
            height: 50px;
            margin-bottom: 10px;
        }

            #divNewCustomer .panel {
                background-color: white;
                height: 50px;
            }

                #divNewCustomer .panel #divNewCustomer_tr {
                    border-top: 2px solid #fff;
                }

        #divProds .divProds_tr {
            border-bottom: 1px solid #e6e5e5;
        }

        #divPrice {
            margin-top: 10px;
            margin-right: 50px;
            display: none;
        }

        #divYH {
            border-bottom: 1px solid #e6e5e5;
            width: 20%;
            float: right;
        }

        #divPayMoney {
            display: none;
            margin-top: -15px;
           
        }

        #divResAmount {
            float: right;
            margin-top: 10px;
        }

         #tiptip_content2 {
            background-color: #fff;
            color:#808080;
            width: 418px;
            height:300px;
            /*height: 300px;*/
            border: 1px solid #DDF4FA;
            -webkit-border-radius: 3px;
            -moz-border-radius: 3px;
            border-radius: 3px;
            -webkit-box-shadow: 0 0 3px #555;
            -moz-box-shadow: 0 0 3px #555;
            box-shadow: 0 0 3px #555;
        }

        #tiptip_contentTip {
            padding: 15px 15px 15px 15px;
            font-size: 11px;
        }

        #tiptipTitle {
            padding: 0px;
            font-weight: 800;
            font-size: larger;
            vertical-align: central;
            color: #00AEAE;
        }
        .btn-info {
        border:none;
         -webkit-border-radius: 3px;
            -moz-border-radius: 3px;
            border-radius: 3px;
            -webkit-box-shadow: 0 0 3px #555;
            -moz-box-shadow: 0 0 3px #555;
            box-shadow: 0 0 3px #555;
        }

    



#tiptip_holder.tip_right #tiptip_arrow {
	/*border-right-color: #555;*/
	border-right-color:#a7a0a0;
}


     #tiptip_content3{
            background-color: #fff;
            color:#808080;
            width: 385px;
            height:300px;
            /*height: 300px;*/
            border: 1px solid #DDF4FA;
            -webkit-border-radius: 3px;
            -moz-border-radius: 3px;
            border-radius: 3px;
            -webkit-box-shadow: 0 0 3px #555;
            -moz-box-shadow: 0 0 3px #555;
            box-shadow: 0 0 3px #555;
        }
        .divemployee {
       
        height:300px;
        
        }
            div.divcontent ul {
            list-style: none;
            color:#808080;
            height:260px;
            overflow:auto;
            overflow-x:hidden;
        }

          #tiptip_content1  div ul li {
                font-size: 12px;
                float: left;
                margin: 5px;
                height: 40px;
                width: 50px;
                background-color: #b3dcd8;
                border: 1px solid #DDF4FA;
                -webkit-border-radius: 3px;
                -moz-border-radius: 3px;
                border-radius: 3px;
                -webkit-box-shadow: 0 0 3px #555;
                -moz-box-shadow: 0 0 3px #555;
                box-shadow: 0 0 3px #555;
            }

                div.divcontent ul li:hover {
                    cursor: pointer;
                }

               

        .test1 {
            background-color: #6ca3d8;
        }

        .test2 {
            background-color: #b3dcd8;
        }

        .content {
            padding: 5px;
        }
    </style>

}
<form action="@Url.Action("Save")" id="formSave" method="post" role="form">
    <div class="s_container">
        <div id="page-heading">
            <h2>
                <i class="fa fa-shopping-cart"></i>&nbsp;购卡</h2>
        </div>

        <div class="row">
            <div class="col-md-4">
                <div class="panel" style="width: 100%">
                    <input type="hidden" id="PROD_NAME_PRICE" style="width: 100%" />
                </div>
                <div class="panel panel-primary">
                    <div id="panelService1" class="tab-container tab-gray">
                        <ul class="nav nav-tabs">
      
                            <li class="active"><a href="#service" data-toggle="tab">储值卡</a></li>
                          <li><a href="#card" data-toggle="tab">疗程卡</a></li>
      
                        </ul>
                        <div id="tab-content" class="tab-content">
                       
                            <div class="tab-pane active" id="service">
                                <div class="form-group">
                                    <div id="serGridlist">
                                    </div>
                                </div>
                            </div>
                           <div class="tab-pane" id="card">
                                <div class="form-group">
                                    <div id="cardGridlist">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                </div>
            </div>
            <div id="divCustomer" class="col-md-8">
                <div class="panel">
                    <div class="panel-body">
                        <div class="col-md-6">
                            <div class="table-responsive">
                                <table class="table table-condensed">
                                    <tbody>
                                        <tr class="divCustomer-tr">
                                            <td style="width: 30%;">顾客姓名</td>
                                            <td>
                                                <span id="spanCustName"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>联系电话</td>
                                            <td><span id="spanCustMobile"></span></td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid #e6e5e5;">
                                            <td>顾客卡号</td>
                                            <td><span id="spanCustCard"></span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="table-responsive">
                                <table class="table table-condensed">
                                    <tbody>
                                        <tr style="border-bottom: 1px solid red; border-top: 2px solid #ffffff;">
                                            <td>订单号</td>
                                            <td><span id="spanOrder_No"></span></td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid #e6e5e5;">
                                            <td>创建时间</td>
                                            <td><span id="spanOrder_Date">@DateTime.Now.ToString("yyyy年MM月dd日")</span>
                                                <input type="hidden" id="hideOrder_Date" value="@DateTime.Now.ToString()" />
                                            </td>
                                        </tr>
                                    @*     <tr style="border-bottom: 1px solid #e6e5e5;">
                                            <td>房&nbsp;&nbsp;&nbsp;&nbsp;间</td>
                                            <td>
                                               @Html.ResourceDropDownList("BED_ID", "BED","", new {  }, null, false)
                                        
                                            </td>
                                        </tr>*@
                                    </tbody>
                                </table>
                            </div>
                        </div>

                    </div>
                </div>

            </div>
            <div id="divNewCustomer" class="col-md-8">
                <div class="panel">
                    <div class="panel-body2">
                        <div class="col-md-7">
                            <div class="table-responsive">
                                <table class="table table-condensed">
                                    <tbody>
                                        <tr class="divNewCustomer_tr">
                                            <td style="width: 20%;vertical-align:middle;">顾客信息</td>
                                            <td>
                                                <input type="hidden" id="CUST_NAME" style="width: 100%" />
                                                
                                            </td>
                                            <td>
                                                <a href="javasrcipt:;" id="firstname" data-type="text" data-pk="2" data-placement="right" data-title="新增顾客信息"><span id="spanCust"></span></a>
                                                
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="col-md-8">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h4>订购卡</h4>
                    </div>
                    <div class="panel-body">
                        <div id="divCart">
                            <img src="~/assets/img/cart.jpg" />
                        </div>
                        <div id="divProds" style="display: none">
                            <table id="tableProds" border="0" style="width: 100%;">
                                <thead>
                                    <tr class="divProds_tr">
                                        <th style="width: 2%">#</th>
                                        <th style="width: 34%">项目名称</th>
                                        <th style="width: 10%; text-align: left">员工</th>
                                        <th style="width: 10%; text-align: left">门市价</th>
                                        <th style="width: 13%; text-align: left">优惠/活动</th>
                                        <th style="width: 13%; text-align: center">最终价格</th>
                                        <th style="width: 8%"></th>
                                    </tr>
                                </thead>
                                <tbody style="font-size: 12px;">
                                </tbody>
                            </table>
                        </div>
                        <div id="divPrice">
                            <table border="0" style="width: 100%">
                                <tr>
                                    <td style="text-align: right;">
                                        <div>
                                            门市总价： <b>¥<span id="spanMSZJ">0.00</span>   </b>

                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="text-align: right;">
                                        <div id="divYH">
                                            优惠： <b>¥<span id="spanYH">0.00</span>  </b>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="text-align: right;">

                                        <h3>应付：<b style="color: red">¥<span id="spanZJ">0.00</span></b></h3>
                                    </td>
                                </tr>
                            </table>

                            

                        </div>

                        <div class="form-group btnpanel_right">
            
                            <button type="button" id="btnSave" style="display:none;" class="btn btn-primary">保存订单</button>
                </div>
                    </div>
                </div>
                <div id="divPayMoney" class="panel panel-primary">
                    <div class="panel-heading">
                        <h4>付款</h4>
                        <div class="options">
                            <span onclick="showPayList()">
                                <h4 style="color: white;"><b>+</b>添加付款</h4>
                            </span>
                        </div>
                    </div>
                    <div class="panel-body" style="display: block;">
                        <div id="divPayType" class="tab-container tab-gray" style="display: none;">
                            <ul class="nav nav-tabs">
                                <li id="vipCard" class="active"><a href="#profile1" data-toggle="tab">会员卡</a></li>
                                <li id="cashCard"><a href="#profile2" data-toggle="tab">现金/刷卡</a></li>
                                <li><a href="#profile3" data-toggle="tab">代金券</a></li>

                            </ul>
                            <div id="divPayTypeContent" class="tab-content">
                                <div class="tab-pane" id="profile1">
                                    <div class="form-group">
                                        <div style="width: 50%;">
                                            @Html.ResourceDropDownList("VIPCARD_TYPE", "VIPCARD_TYPE", "类型", new { @class = "form-control" },Request.QueryString["cid"],false)
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div style="width: 50%;">

                                        <input type="text" maxlength="8" id="payMoneyVIPCARD" onkeypress="keyPress(this)" onkeyup="keyUp(this)" onblur="onBlur(this)" name="payMoneyVIPCARD" class="form-control mask"  placeholder="请输入支付金额" >
                                             </div>

                                    </div>
                                    <div>
                                        <button type="button" onclick="showPayList()" class="btn btn-default">取消</button>
                                        &nbsp;&nbsp;
                                        <button type="button" id="btnVIPCARD" class="btn btn-primary">添加这个付款</button>
                                    </div>
                                </div>
                                <div class="tab-pane" id="profile2">
                                    <div class="form-group">
                                        <div style="width: 50%;">
                                            @Html.ResourceDropDownList("POSTCARD_TYPE", "POSTCARD_TYPE", "类型", new { @class = "form-control" })
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div style="width: 50%;">
                                            <input type="text" class="form-control" maxlength="8" onkeypress="keyPress(this)" onkeyup="keyUp(this)" onblur="onBlur(this)" placeholder="请输入支付金额" id="payMoneyPOSTCARD" name="payMoneyPOSTCARD" />
                                        </div>

                                    </div>
                                    <div>
                                        <button type="button" onclick="showPayList()" class="btn btn-default">取消</button>
                                        &nbsp;&nbsp;
                                        <button type="button" id="btnPOSTCARD" class="btn btn-primary">添加这个付款</button>
                                    </div>
                                </div>
                                <div class="tab-pane" id="profile3">
                                      <div class="form-group">
                                        <div style="width: 40%;float:left;">
                                            <input type="text" class="form-control" maxlength="30" placeholder="编码" id="txtVOUCHAR_NO" name="VOUCHAR_NO" />
                                                                                         
                                        </div>
                                          <div style="float:left;">

                                              <button type="button" id="btnCheckPROM" class="btn btn-primary">校验</button>
                                          </div>
                                    </div>
                                      <div class="form-group" style="clear:both;">
                                        <div>
                                            校验信息：
                                            <label id="Pro_Voucher"></label>
                                            <input id="Pro_FaceValue" value="0" type="hidden" />
                                        </div>
                                    </div> 
                                   
                                    <div class="form-group">
                                        <button type="button" onclick="showPayList()" class="btn btn-default">取消</button>
                                        &nbsp;&nbsp;
                                        <button type="button" id="btnPROM" class="btn btn-primary">添加这个付款</button>
                                    </div>
                                </div>

                            </div>
                        </div>
                        <div id="divPayMessage" style="display: block;">
                            还没有付款 <a href="javascript:;" onclick="showPayList()">添加付款》》</a>
                        </div>
                        <div id="divPayList" style="display: none;">
                            <table id="tablePayList" style="width: 100%;">
                                <thead>
                                    <tr style="border-bottom: 1px solid #e6e5e5">
                                        <th style="width:20%">#付款方式</th>
                                        <th style="width:40%">支付类型</th>
                                        <th style="width:30%">支付金额</th>
                                         <th style="width:10%"></th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                            <div id="divResAmount">
                                <div class="alert alert-dismissable alert-warning" style="height: 50px;">
                                    <span class="fa fa-exclamation-triangle"></span><b>剩余未支付：￥<span id="spanResAmount">0</span></b>
                                </div>
                            </div>
                        </div>

                         
                    </div>
                </div>
                <div class="form-group btnpanel_right" id="divBtnSave" style="display: none">
                    <button type="button" id="btnContPay" onclick="showPayList()" class="btn btn-primary">继续付款 </button>
                    <button type="button" id="btnSubmit" class="btn btn-primary">下单出票 </button>
                    @*<button type="button" id="btnSave" class="btn btn-primary">保存订单</button>*@
                </div>
            </div>
        </div>
    </div>

    <div id="confirmModal" class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;</button>
                    <h4 class="modal-title">请输入操作密码！</h4>
                </div>
                <div class="modal-body">
                    <p>
                        <input type="text" />
                    </p>
                    <input id="hdCurrentId" type="hidden" value="" />
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">
                        取 消</button>
                    <button type="button" id="btnConfirm" class="btn btn-primary">
                        确 定</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
    <!-- /.modal -->

    <div style="display: none;">
        <textarea readonly="readonly" class="fullscreen" style="display: none; height: 0px; width: 0px;"></textarea>
    </div>
 @*   <input type="hidden" id="custId" />
    <input type="hidden" id="hide_CUST_NAME" />
    <input type="hidden" id="hide_MOBILE" />*@
    <input type="hidden" id="hide_Cid" name="CUST_ID" value="@Request.QueryString["cid"]" />
    <input type="hidden" id="hide_Oid" name="ORDER_ID" value="@Request.QueryString["oid"]" />
    <input type="hidden" id="hide_MSZJ" name="TOTAL_AMT" />
    <input type="hidden" id="hide_ZJ" name="PAY_AMT" />
    <input type="hidden" id="hidePAYED_AMT" name="PAYED_AMT" />
    <input type="hidden" id="hide_SubmitType" name="SubmitType" />
</form>
<link href="~/assets/js/jquery-ui-1.10.4.custom.min.css" rel="stylesheet" />
<link rel='stylesheet' type='text/css' href='~/assets/plugins/form-select2/select2.css' />
@section jssection{
    <script type="text/javascript">
        var util = {}; var options = {
            listUrl: "@Url.Action("List", "Customer")",
            editUrl: "@Url.Action("Edit")",
            deleteUrl: "@Url.Action("Delete")",
            queryCustomerUrl: "@Url.Action("QueryCustomer", "Customer", new { type = "name" })",
            queryGodSerCardUrl: "@Url.Action("QueryGodSerCard", new { type="card"})",
            cardlistUrl: "@Url.Action("List", "Card")",
            treatcardUrl:"@Url.Action("List","Treatmentcard")",
            returnListUrl: "@Url.Action("OrderList")",
            queryEmployeeBy: "@Url.Action("QueryEmployeeBy","Common")",
            checkVOCHER_NO: "@Url.Action("CheckVocherNo")"
        };
    </script>

    @Html.Js("app/order/xjgrid", "plugins/jquery-tip/jquery.tip", "js/jquery-ui-1.10.4.custom.min", "app/order/ordercard")
    @Html.Js("plugins/validator/validator")
    @Html.Js("plugins/form-typeahead/typeahead.min", "plugins/form-select2/select2")
    <script type='text/javascript' src='../../assets/plugins/form-inputmask/jquery.inputmask.bundle.min.js'></script>
    <script type='text/javascript' src='../../assets/demo/demo-mask.js'></script>

}

